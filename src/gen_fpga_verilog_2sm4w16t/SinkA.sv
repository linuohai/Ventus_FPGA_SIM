// Generated by CIRCT firtool-1.62.0
// Standard header to adapt well known macros for register randomization.
`ifndef RANDOMIZE
  `ifdef RANDOMIZE_MEM_INIT
    `define RANDOMIZE
  `endif // RANDOMIZE_MEM_INIT
`endif // not def RANDOMIZE
`ifndef RANDOMIZE
  `ifdef RANDOMIZE_REG_INIT
    `define RANDOMIZE
  `endif // RANDOMIZE_REG_INIT
`endif // not def RANDOMIZE

// RANDOM may be set to an expression that produces a 32-bit random unsigned value.
`ifndef RANDOM
  `define RANDOM $random
`endif // not def RANDOM

// Users can define INIT_RANDOM as general code that gets injected into the
// initializer block for modules with registers.
`ifndef INIT_RANDOM
  `define INIT_RANDOM
`endif // not def INIT_RANDOM

// If using random initialization, you can also define RANDOMIZE_DELAY to
// customize the delay used, otherwise 0.002 is used.
`ifndef RANDOMIZE_DELAY
  `define RANDOMIZE_DELAY 0.002
`endif // not def RANDOMIZE_DELAY

// Define INIT_RANDOM_PROLOG_ for use in our modules below.
`ifndef INIT_RANDOM_PROLOG_
  `ifdef RANDOMIZE
    `ifdef VERILATOR
      `define INIT_RANDOM_PROLOG_ `INIT_RANDOM
    `else  // VERILATOR
      `define INIT_RANDOM_PROLOG_ `INIT_RANDOM #`RANDOMIZE_DELAY begin end
    `endif // VERILATOR
  `else  // RANDOMIZE
    `define INIT_RANDOM_PROLOG_
  `endif // RANDOMIZE
`endif // not def INIT_RANDOM_PROLOG_

// Include register initializers in init blocks unless synthesis is set
`ifndef SYNTHESIS
  `ifndef ENABLE_INITIAL_REG_
    `define ENABLE_INITIAL_REG_
  `endif // not def ENABLE_INITIAL_REG_
`endif // not def SYNTHESIS

// Include rmemory initializers in init blocks unless synthesis is set
`ifndef SYNTHESIS
  `ifndef ENABLE_INITIAL_MEM_
    `define ENABLE_INITIAL_MEM_
  `endif // not def ENABLE_INITIAL_MEM_
`endif // not def SYNTHESIS

// Standard header to adapt well known macros for prints and assertions.

// Users can define 'PRINTF_COND' to add an extra gate to prints.
`ifndef PRINTF_COND_
  `ifdef PRINTF_COND
    `define PRINTF_COND_ (`PRINTF_COND)
  `else  // PRINTF_COND
    `define PRINTF_COND_ 1
  `endif // PRINTF_COND
`endif // not def PRINTF_COND_

// Users can define 'ASSERT_VERBOSE_COND' to add an extra gate to assert error printing.
`ifndef ASSERT_VERBOSE_COND_
  `ifdef ASSERT_VERBOSE_COND
    `define ASSERT_VERBOSE_COND_ (`ASSERT_VERBOSE_COND)
  `else  // ASSERT_VERBOSE_COND
    `define ASSERT_VERBOSE_COND_ 1
  `endif // ASSERT_VERBOSE_COND
`endif // not def ASSERT_VERBOSE_COND_

// Users can define 'STOP_COND' to add an extra gate to stop conditions.
`ifndef STOP_COND_
  `ifdef STOP_COND
    `define STOP_COND_ (`STOP_COND)
  `else  // STOP_COND
    `define STOP_COND_ 1
  `endif // STOP_COND
`endif // not def STOP_COND_

module SinkA(	// ventus/src/L2cache/SinkA.scala:33:7
  input           clock,	// ventus/src/L2cache/SinkA.scala:33:7
                  reset,	// ventus/src/L2cache/SinkA.scala:33:7
                  io_req_ready,	// ventus/src/L2cache/SinkA.scala:35:14
  output          io_req_valid,	// ventus/src/L2cache/SinkA.scala:35:14
  output [2:0]    io_req_bits_opcode,	// ventus/src/L2cache/SinkA.scala:35:14
  output [15:0]   io_req_bits_source,	// ventus/src/L2cache/SinkA.scala:35:14
  output [18:0]   io_req_bits_tag,	// ventus/src/L2cache/SinkA.scala:35:14
  output [6:0]    io_req_bits_offset,	// ventus/src/L2cache/SinkA.scala:35:14
  output [4:0]    io_req_bits_put,	// ventus/src/L2cache/SinkA.scala:35:14
  output [1023:0] io_req_bits_data,	// ventus/src/L2cache/SinkA.scala:35:14
  output [127:0]  io_req_bits_mask,	// ventus/src/L2cache/SinkA.scala:35:14
  output [2:0]    io_req_bits_param,	// ventus/src/L2cache/SinkA.scala:35:14
  output [31:0]   io_req_bits_spike_info_pc,	// ventus/src/L2cache/SinkA.scala:35:14
                  io_req_bits_spike_info_vaddr,	// ventus/src/L2cache/SinkA.scala:35:14
  output [5:0]    io_req_bits_set,	// ventus/src/L2cache/SinkA.scala:35:14
  output          io_a_ready,	// ventus/src/L2cache/SinkA.scala:35:14
  input           io_a_valid,	// ventus/src/L2cache/SinkA.scala:35:14
  input  [2:0]    io_a_bits_opcode,	// ventus/src/L2cache/SinkA.scala:35:14
  input  [15:0]   io_a_bits_source,	// ventus/src/L2cache/SinkA.scala:35:14
  input  [31:0]   io_a_bits_address,	// ventus/src/L2cache/SinkA.scala:35:14
  input  [127:0]  io_a_bits_mask,	// ventus/src/L2cache/SinkA.scala:35:14
  input  [1023:0] io_a_bits_data,	// ventus/src/L2cache/SinkA.scala:35:14
  input  [2:0]    io_a_bits_param,	// ventus/src/L2cache/SinkA.scala:35:14
  input  [31:0]   io_a_bits_spike_info_pc,	// ventus/src/L2cache/SinkA.scala:35:14
                  io_a_bits_spike_info_vaddr,	// ventus/src/L2cache/SinkA.scala:35:14
  input           io_pb_pop_valid,	// ventus/src/L2cache/SinkA.scala:35:14
  input  [4:0]    io_pb_pop_bits_index,	// ventus/src/L2cache/SinkA.scala:35:14
  output [1023:0] io_pb_beat_data,	// ventus/src/L2cache/SinkA.scala:35:14
  output [127:0]  io_pb_beat_mask	// ventus/src/L2cache/SinkA.scala:35:14
);

  wire [31:0] lists_clr;	// ventus/src/L2cache/SinkA.scala:54:27, :108:25, :109:19
  wire        io_empty;	// ventus/src/L2cache/SinkA.scala:107:15
  wire        io_pb_pop_ready;	// ventus/src/L2cache/SinkA.scala:102:40
  wire [31:0] lists_set;	// ventus/src/L2cache/SinkA.scala:53:27, :76:{57,69}
  wire        _putbuffer_io_push_ready;	// ventus/src/L2cache/SinkA.scala:50:25
  wire [31:0] _putbuffer_io_valid;	// ventus/src/L2cache/SinkA.scala:50:25
  reg  [31:0] lists;	// ventus/src/L2cache/SinkA.scala:51:22
  wire [31:0] _io_empty_T = lists | lists_set;	// ventus/src/L2cache/SinkA.scala:51:22, :53:27, :55:19, :76:{57,69}
  wire [31:0] _freeOH_T_19 = ~lists;	// ventus/src/L2cache/SinkA.scala:51:22, :59:23
  wire [30:0] _freeOH_T_3 = _freeOH_T_19[30:0] | {_freeOH_T_19[29:0], 1'h0};	// dependencies/rocket-chip/src/main/scala/util/package.scala:253:{43,53}, ventus/src/L2cache/SinkA.scala:33:7, :59:23
  wire [30:0] _freeOH_T_6 = _freeOH_T_3 | {_freeOH_T_3[28:0], 2'h0};	// dependencies/rocket-chip/src/main/scala/util/package.scala:253:{43,48,53}
  wire [30:0] _freeOH_T_9 = _freeOH_T_6 | {_freeOH_T_6[26:0], 4'h0};	// dependencies/rocket-chip/src/main/scala/util/package.scala:253:{43,48,53}
  wire [30:0] _freeOH_T_12 = _freeOH_T_9 | {_freeOH_T_9[22:0], 8'h0};	// dependencies/rocket-chip/src/main/scala/util/package.scala:253:{43,48,53}
  wire [31:0] freeOH =
    {~(_freeOH_T_12 | {_freeOH_T_12[14:0], 16'h0}), 1'h1} & _freeOH_T_19;	// dependencies/rocket-chip/src/main/scala/util/package.scala:253:{43,48,53}, ventus/src/L2cache/SinkA.scala:33:7, :59:{13,23,53}
  wire [14:0] _freeIdx_T_1 = freeOH[31:17] | freeOH[15:1];	// src/main/scala/chisel3/util/OneHot.scala:30:18, :31:18, :32:28, ventus/src/L2cache/SinkA.scala:59:53
  wire [6:0]  _freeIdx_T_3 = _freeIdx_T_1[14:8] | _freeIdx_T_1[6:0];	// src/main/scala/chisel3/util/OneHot.scala:30:18, :31:18, :32:28
  wire [2:0]  _freeIdx_T_5 = _freeIdx_T_3[6:4] | _freeIdx_T_3[2:0];	// src/main/scala/chisel3/util/OneHot.scala:30:18, :31:18, :32:28
  wire [4:0]  freeIdx =
    {|(freeOH[31:16]),
     |(_freeIdx_T_1[14:7]),
     |(_freeIdx_T_3[6:3]),
     |(_freeIdx_T_5[2:1]),
     _freeIdx_T_5[2] | _freeIdx_T_5[0]};	// src/main/scala/chisel3/util/OneHot.scala:30:18, :31:18, :32:{10,14,28}, ventus/src/L2cache/SinkA.scala:59:53
  wire        hasData = io_a_bits_opcode == 3'h0 | io_a_bits_opcode == 3'h1;	// ventus/src/L2cache/Parameters.scala:174:{16,23,39}
  wire        buf_block = hasData & ~_putbuffer_io_push_ready;	// ventus/src/L2cache/Parameters.scala:174:23, ventus/src/L2cache/SinkA.scala:50:25, :69:{27,30}
  wire        set_block = hasData & (&lists);	// ventus/src/L2cache/Parameters.scala:174:23, ventus/src/L2cache/SinkA.scala:51:22, :57:21, :70:27
  wire        _io_req_valid_T = io_a_bits_opcode == 3'h5;	// ventus/src/L2cache/SinkA.scala:73:31
  wire        _putbuffer_io_push_valid_T = io_a_valid & hasData;	// ventus/src/L2cache/Parameters.scala:174:23, ventus/src/L2cache/SinkA.scala:75:38
  assign lists_set =
    _putbuffer_io_push_valid_T & io_req_ready & ~buf_block ? freeOH : 32'h0;	// ventus/src/L2cache/SinkA.scala:51:22, :53:27, :59:53, :69:27, :73:52, :75:38, :76:{42,57,69}
  wire        _putbuffer_io_pop_valid_T = io_pb_pop_ready & io_pb_pop_valid;	// src/main/scala/chisel3/util/Decoupled.scala:51:35, ventus/src/L2cache/SinkA.scala:102:40
  wire [31:0] _GEN = {27'h0, io_pb_pop_bits_index};	// ventus/src/L2cache/SinkA.scala:102:40
  wire [31:0] _io_pb_pop_ready_T = _putbuffer_io_valid >> _GEN;	// ventus/src/L2cache/SinkA.scala:50:25, :102:40
  assign io_pb_pop_ready = _io_pb_pop_ready_T[0];	// ventus/src/L2cache/SinkA.scala:102:40
  assign io_empty = (_io_empty_T & ~lists_clr) == 32'h0;	// ventus/src/L2cache/SinkA.scala:51:22, :54:27, :55:{19,35}, :107:{15,37}, :108:25, :109:19
  assign lists_clr = _putbuffer_io_pop_valid_T ? 32'h1 << _GEN : 32'h0;	// src/main/scala/chisel3/util/Decoupled.scala:51:35, src/main/scala/chisel3/util/OneHot.scala:65:12, ventus/src/L2cache/SinkA.scala:51:22, :54:27, :102:40, :108:25, :109:19
  always @(posedge clock) begin	// ventus/src/L2cache/SinkA.scala:33:7
    if (reset)	// ventus/src/L2cache/SinkA.scala:33:7
      lists <= 32'h0;	// ventus/src/L2cache/SinkA.scala:51:22
    else	// ventus/src/L2cache/SinkA.scala:33:7
      lists <= _io_empty_T & ~lists_clr;	// ventus/src/L2cache/SinkA.scala:51:22, :54:27, :55:{19,32,35}, :108:25, :109:19
  end // always @(posedge)
  `ifdef ENABLE_INITIAL_REG_	// ventus/src/L2cache/SinkA.scala:33:7
    `ifdef FIRRTL_BEFORE_INITIAL	// ventus/src/L2cache/SinkA.scala:33:7
      `FIRRTL_BEFORE_INITIAL	// ventus/src/L2cache/SinkA.scala:33:7
    `endif // FIRRTL_BEFORE_INITIAL
    initial begin	// ventus/src/L2cache/SinkA.scala:33:7
      automatic logic [31:0] _RANDOM[0:0];	// ventus/src/L2cache/SinkA.scala:33:7
      `ifdef INIT_RANDOM_PROLOG_	// ventus/src/L2cache/SinkA.scala:33:7
        `INIT_RANDOM_PROLOG_	// ventus/src/L2cache/SinkA.scala:33:7
      `endif // INIT_RANDOM_PROLOG_
      `ifdef RANDOMIZE_REG_INIT	// ventus/src/L2cache/SinkA.scala:33:7
        _RANDOM[/*Zero width*/ 1'b0] = `RANDOM;	// ventus/src/L2cache/SinkA.scala:33:7
        lists = _RANDOM[/*Zero width*/ 1'b0];	// ventus/src/L2cache/SinkA.scala:33:7, :51:22
      `endif // RANDOMIZE_REG_INIT
    end // initial
    `ifdef FIRRTL_AFTER_INITIAL	// ventus/src/L2cache/SinkA.scala:33:7
      `FIRRTL_AFTER_INITIAL	// ventus/src/L2cache/SinkA.scala:33:7
    `endif // FIRRTL_AFTER_INITIAL
  `endif // ENABLE_INITIAL_REG_
  ListBuffer putbuffer (	// ventus/src/L2cache/SinkA.scala:50:25
    .clock                  (clock),
    .reset                  (reset),
    .io_push_ready          (_putbuffer_io_push_ready),
    .io_push_valid          (_putbuffer_io_push_valid_T & io_req_ready & ~set_block),	// ventus/src/L2cache/SinkA.scala:70:27, :73:66, :75:{38,63}
    .io_push_bits_index     (freeIdx),	// src/main/scala/chisel3/util/OneHot.scala:32:10
    .io_push_bits_data_data (io_a_bits_data),
    .io_push_bits_data_mask (io_a_bits_mask),
    .io_valid               (_putbuffer_io_valid),
    .io_pop_valid           (_putbuffer_io_pop_valid_T),	// src/main/scala/chisel3/util/Decoupled.scala:51:35
    .io_pop_bits            (io_pb_pop_bits_index),
    .io_data_data           (io_pb_beat_data),
    .io_data_mask           (io_pb_beat_mask)
  );
  assign io_req_valid =
    _io_req_valid_T
      ? io_a_valid & ~buf_block & ~set_block & io_empty
      : io_a_valid & ~buf_block & ~set_block;	// ventus/src/L2cache/SinkA.scala:33:7, :69:27, :70:27, :73:{31,52,66}, :74:{22,78,111}, :107:15
  assign io_req_bits_opcode = io_a_bits_opcode;	// ventus/src/L2cache/SinkA.scala:33:7
  assign io_req_bits_source = io_a_bits_source;	// ventus/src/L2cache/SinkA.scala:33:7
  assign io_req_bits_tag = io_a_bits_address[31:13];	// ventus/src/L2cache/Parameters.scala:221:22, :222:19, ventus/src/L2cache/SinkA.scala:33:7
  assign io_req_bits_offset = io_a_bits_address[6:0];	// ventus/src/L2cache/Parameters.scala:224:92, ventus/src/L2cache/SinkA.scala:33:7
  assign io_req_bits_put = freeIdx;	// src/main/scala/chisel3/util/OneHot.scala:32:10, ventus/src/L2cache/SinkA.scala:33:7
  assign io_req_bits_data = io_a_bits_data;	// ventus/src/L2cache/SinkA.scala:33:7
  assign io_req_bits_mask = io_a_bits_mask;	// ventus/src/L2cache/SinkA.scala:33:7
  assign io_req_bits_param = io_a_bits_param;	// ventus/src/L2cache/SinkA.scala:33:7
  assign io_req_bits_spike_info_pc = io_a_bits_spike_info_pc;	// ventus/src/L2cache/SinkA.scala:33:7
  assign io_req_bits_spike_info_vaddr = io_a_bits_spike_info_vaddr;	// ventus/src/L2cache/SinkA.scala:33:7
  assign io_req_bits_set = io_a_bits_address[12:7];	// ventus/src/L2cache/Parameters.scala:221:22, :224:70, ventus/src/L2cache/SinkA.scala:33:7
  assign io_a_ready =
    _io_req_valid_T
      ? io_req_ready & ~buf_block & ~set_block & io_empty
      : io_req_ready & ~buf_block & ~set_block;	// ventus/src/L2cache/SinkA.scala:33:7, :69:27, :70:27, :73:{17,31,52,66,77,114}, :107:15
endmodule

